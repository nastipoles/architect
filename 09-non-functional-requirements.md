# 09. Анализ и список нефункциональных требований

Нефункциональные требования разделены на следующие категории:


## 1. Производительность и масштабируемость

1. **Время отклика:**
   - 80% запросов к публичным API должны обрабатываться быстрее, чем за 2 секунды; 95% — не более 3 секунд.
   - Измеряется временем отклика на уровне API Gateway.

2. **Пропускная способность:**
   - Система должна поддерживать не менее 5000 RPS (Requests Per Second) при пиковых нагрузках во время массовых челленджей.
   - Измеряется пиковым количеством RPS без существенного увеличения времени ожидания (> 5 секунд).

3. **Горизонтальное масштабирование:**
   - Каждый микросервис должен позволять запуск нескольких реплик в Kubernetes без ручных модификаций кода или конфигураций.
   - Мониторинг ресурсов (CPU, RAM) и время на развёртывание новых подов.

4. **Пиковая нагрузка при массовых мероприятиях:**
   - Система должна выдерживать в X раз большую нагрузку в течение Y часов (например, при запуске всемирного челленджа), сохраняя доступность не ниже 99%.


## 2. Доступность и надежность

1. **Уровень доступности:**
   - Критические сервисы (User & Identity, Workout & Analytics, Social & Gamification) должны обеспечивать доступность 99.9% в режиме 24/7.
   - Измеряется процентом недоступности за отчетный период (месяц/квартал).

2. **Восстановление после сбоя:**
   - При отказе ноды или выходе из строя одного из регионов система должна восстанавливаться и быть доступной не более чем за 15 минут.
   - Проверяется через периодические тесты с имитацией сбоев.

3. **Сохранность данных:**
   - Максимально допустимая потеря данных при аварии — не более 1 минуты.
   - Проверяется механизмами бэкапов и репликации.


## 3. Безопасность и конфиденциальность

1. **Защищенная передача данных:**
   - Все внешние и внутренние API-коммуникации осуществляются по HTTPS/TLS.

2. **Шифрование "на хранении":**
   - Персональные данные (профили пользователей, результаты тренировок) шифруются в хранилище.

3. **Регулируемость прав доступа:**
   - Все сервисы и админ-интерфейсы имеют ролевую модель, запрещена «прямая» работа с базами данных без аутентификации.
   - Контроль и аудит доступа.


## 4. Интероперабельность и интеграция

1. **API-совместимость:**
   - Публичные API оформлены по единым стандартам, документация (OpenAPI/Swagger) должна быть доступна.
   - Проверяется автоматической валидацией контрактов.

2. **Интеграция с фитнес-устройствами:**
   - Поддержка минимум N популярных производителей через их официальные API.
   - Измеряется перечнем поддерживаемых устройств и отсутствием критичных багов при интеграциях.

3. **Интеграция с e-commerce:**
   - Единая авторизация (SSO), синхронизация заказов/корзин, передача статуса заказа через брокер.
   - Проверяется тестовыми сценариями и целостностью данных в CRM.


## 5. Управляемость / Наблюдаемость

1. **Логирование:**
   - Центральное хранилище логов, где каждый сервис пишет структурированные логи, индексируемые для поиска по ключевым полям.

2. **Метрики и алертинг:**
   - Ключевые метрики собираются в Prometheus, Grafana; настроены алерты на критические отклонения.
   - Проводится регулярная оценка SLA и способность команды реагировать 24/7.


## 6. Удобство и скорость развертывания (DevOps)

1. **CI/CD Pipeline:**
   - Каждое изменение кода или конфигурации проходит автоматическую сборку, юнит-тесты, статический анализ и может быть выкатано в staging/prod по клику.

2. **Изоляция окружений:**
   - Отдельные среды для разработки, тестирования и эксплуатации с четким контролем доступа.

3. **Возможность канареечного тестирования:**
   - Без простоя можно выкатывать новые версии сервисов и быстро откатываться в случае проблем.


## 7. Юридические и нормативные требования

1. **GDPR и локальные аналоги:**
   - Соблюдение прав субъектов данных (доступ, удаление, ограничение обработки) и уведомление о способах обработки.

2. **Локальные законы о рекламе:**
   - Корректная маркировка рекламных сообщений и учет возрастных ограничений.
